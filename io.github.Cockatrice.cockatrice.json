{
  "app-id": "io.github.Cockatrice.cockatrice",
  "runtime": "org.kde.Platform",
  "runtime-version": "6.7",
  "sdk": "org.kde.Sdk",
  "command": "cockatrice",
  "rename-desktop-file": "cockatrice.desktop",
  "rename-icon": "cockatrice",
  "copy-icon": true,
  "finish-args": [
    "--share=ipc",
    "--share=network",
    "--socket=fallback-x11",
    "--socket=wayland",
    "--filesystem=home"
  ],
  "cleanup": [
    "*.la",
    "*.a",
    "/include",
    "/lib/cmake",
    "/lib/pkgconfig"
  ],
  "modules": [
    {
      "name": "abseil",
      "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_CXX_STANDARD=17",
                "-DCMAKE_POSITION_INDEPENDENT_CODE=ON",
                "-DBUILD_SHARED_LIBS=ON",
                "-DABSL_PROPAGATE_CXX_STD=ON"
            ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/abseil/abseil-cpp/archive/refs/tags/20240116.2.tar.gz",
          "sha256": "733726b8c3a6d39a4120d7e45ea8b41a434cdacde401cba500f14236c49b39dc"
        }
      ]
    },
    {
      "name": "protobuf",
      "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DCMAKE_POSITION_INDEPENDENT_CODE=ON",
                "-Dprotobuf_ABSL_PROVIDER=package",
                "-Dprotobuf_BUILD_SHARED_LIBS=ON",
                "-Dprotobuf_BUILD_TESTS=OFF"
            ],
      "cleanup": [
        "protoc",
        "/bin",
        "/doc",
        "/lib/plugins"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://github.com/protocolbuffers/protobuf/releases/download/v28.0-rc1/protobuf-28.0-rc1.tar.gz",
          "sha256": "3c6de11cec5ca052c9e60b2a4e35a275f69bd55f380708914d8e0a019b389387"
        }
      ]
    },    
    {
      "name": "cockatrice",
      "buildsystem": "cmake-ninja",
      "config-opts": [
        "-DBUILD_SHARED_LIBS:BOOL=OFF"
      ],
      "sources": [
        {
          "type": "git",
          "tag": "2023-09-14-Release-2.9.0",
          "url": "https://github.com/Cockatrice/Cockatrice.git"
        },
        {
          "type": "file",
          "path": "io.github.Cockatrice.cockatrice.metainfo.xml"
        }
      ],
      "post-install": [
        "install -Dm644 io.github.Cockatrice.cockatrice.metainfo.xml -t /app/share/metainfo",
        "for size in 64 128 256 512; do rsvg-convert -w $size -h $size -f png -o $size.png /app/share/icons/hicolor/scalable/apps/cockatrice.svg; install -Dm644 $size.png /app/share/icons/hicolor/${size}x${size}/apps/cockatrice.png; done"
      ]
    }
  ]
}
